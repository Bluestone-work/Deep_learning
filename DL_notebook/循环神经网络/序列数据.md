实际中很多数据都是有时序结构的
电影的评价随时间变化而变化
	拿奖之后评分上升，直到奖项被忘记
	看了很多电影后，人们的期望变高
	季节性：贺岁档，暑期档
	导演、演员负面评价

## 序列数据
音乐、语言、文本和视频都是连续的
标题“狗咬人”远没有“人咬狗”那么令人惊讶
大地震发生之后，很可能会出现几次比较小的余震
人的互动是连续的，从网上的吵架可以看出

## 统计工具
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927160139.png)
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927160143.png)
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927160818.png)
知道过去的事情，推未来的事情
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927160959.png)
在过去的T-1上训练一个模型，来预测下一个T。标号和真实的样本是一个东西：也叫做自回归模型
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927160800.png)知道未来的事情，推过去的事情

### 方案一
马尔可夫假设
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927161146.png)
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927161156.png)

![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927161358.png)
在上面train一个多层感知机。对f建模

### 方案二：潜变量模型
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927161512.png)
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927161527.png)
两个问题：
1.如何计算h
2.如何根据h和前一个信息x来计算下一个x

## 总结
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927161828.png)
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927161834.png)
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927161840.png)
```
#将数据映射为yt = xt 和xt = [xt-tau,...,xt-1]，yt就表示预测第t个时间的数据。

#从第五个时刻开始，每个时刻读入的label是该时刻的x值，该时刻的输入是前4个时刻组成的一个整体向量。所以训练数据的输入共有996个4维数据，输入时996个值。

tau = 4

features = torch.zeros((T - tau, tau))#T-tau是样本数，tau是特征数

for i in range(tau):

    features[:, i] = x[i: T - tau + i]

labels = x[tau:].reshape((-1, 1))
```
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927165028.png)
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927165040.png)
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927173934.png)
![image.png](https://cdn.jsdelivr.net/gh/Bluestone-work/image/image/20240927174005.png)